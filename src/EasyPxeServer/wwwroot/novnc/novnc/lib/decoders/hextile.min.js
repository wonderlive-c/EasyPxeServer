/**
 * Minified by jsDelivr using Terser v5.39.0.
 * Original file: /npm/@novnc/novnc@1.6.0/lib/decoders/hextile.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var Log=_interopRequireWildcard(require("../util/logging.js"));function _getRequireWildcardCache(t){if("function"!=typeof WeakMap)return null;var e=new WeakMap,i=new WeakMap;return(_getRequireWildcardCache=function(t){return t?i:e})(t)}function _interopRequireWildcard(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!=_typeof(t)&&"function"!=typeof t)return{default:t};var i=_getRequireWildcardCache(e);if(i&&i.has(t))return i.get(t);var r={__proto__:null},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in t)if("default"!==o&&{}.hasOwnProperty.call(t,o)){var s=n?Object.getOwnPropertyDescriptor(t,o):null;s&&(s.get||s.set)?Object.defineProperty(r,o,s):r[o]=t[o]}return r.default=t,i&&i.set(t,r),r}function _typeof(t){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,_toPropertyKey(r.key),r)}}function _createClass(t,e,i){return e&&_defineProperties(t.prototype,e),i&&_defineProperties(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=_typeof(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var HextileDecoder=exports.default=function(){return _createClass((function t(){_classCallCheck(this,t),this._tiles=0,this._lastsubencoding=0,this._tileBuffer=new Uint8Array(1024)}),[{key:"decodeRect",value:function(t,e,i,r,n,o,s){for(0===this._tiles&&(this._tilesX=Math.ceil(i/16),this._tilesY=Math.ceil(r/16),this._totalTiles=this._tilesX*this._tilesY,this._tiles=this._totalTiles);this._tiles>0;){var l=1;if(n.rQwait("HEXTILE",l))return!1;var a=n.rQpeek8();if(a>30)throw new Error("Illegal hextile subencoding (subencoding: "+a+")");var f=this._totalTiles-this._tiles,u=t+16*(f%this._tilesX),_=e+16*Math.floor(f/this._tilesX),c=Math.min(16,t+i-u),h=Math.min(16,e+r-_);if(1&a)l+=c*h*4;else if(2&a&&(l+=4),4&a&&(l+=4),8&a){if(l++,n.rQwait("HEXTILE",l))return!1;var y=n.rQpeekBytes(l).at(-1);l+=16&a?6*y:2*y}if(n.rQwait("HEXTILE",l))return!1;if(n.rQshift8(),0===a)1&this._lastsubencoding?Log.Debug("     Ignoring blank after RAW"):o.fillRect(u,_,c,h,this._background);else if(1&a){for(var p=c*h,d=n.rQshiftBytes(4*p,!1),b=0;b<p;b++)d[4*b+3]=255;o.blitImage(u,_,c,h,d,0)}else{if(2&a&&(this._background=new Uint8Array(n.rQshiftBytes(4))),4&a&&(this._foreground=new Uint8Array(n.rQshiftBytes(4))),this._startTile(u,_,c,h,this._background),8&a)for(var v=n.rQshift8(),g=0;g<v;g++){var m=void 0;m=16&a?n.rQshiftBytes(4):this._foreground;var w=n.rQshift8(),P=w>>4,k=15&w,T=n.rQshift8(),Q=1+(T>>4),W=1+(15&T);this._subTile(P,k,Q,W,m)}this._finishTile(o)}this._lastsubencoding=a,this._tiles--}return!0}},{key:"_startTile",value:function(t,e,i,r,n){this._tileX=t,this._tileY=e,this._tileW=i,this._tileH=r;for(var o=n[0],s=n[1],l=n[2],a=this._tileBuffer,f=0;f<i*r*4;f+=4)a[f]=o,a[f+1]=s,a[f+2]=l,a[f+3]=255}},{key:"_subTile",value:function(t,e,i,r,n){for(var o=n[0],s=n[1],l=n[2],a=t+i,f=e+r,u=this._tileBuffer,_=this._tileW,c=e;c<f;c++)for(var h=t;h<a;h++){var y=4*(h+c*_);u[y]=o,u[y+1]=s,u[y+2]=l,u[y+3]=255}}},{key:"_finishTile",value:function(t){t.blitImage(this._tileX,this._tileY,this._tileW,this._tileH,this._tileBuffer,0)}}])}();
//# sourceMappingURL=/sm/300340bd09c2d6cc532a197fc660b03b3c9c5c6230b5ace74e365a67b8d4e266.map