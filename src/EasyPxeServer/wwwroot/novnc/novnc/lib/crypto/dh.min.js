/**
 * Minified by jsDelivr using Terser v5.39.0.
 * Original file: /npm/@novnc/novnc@1.6.0/lib/crypto/dh.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.DHCipher=void 0;var _bigint=require("./bigint.js");function _typeof(t){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,_toPropertyKey(r.key),r)}}function _createClass(t,e,i){return e&&_defineProperties(t.prototype,e),i&&_defineProperties(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=_typeof(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var DHPublicKey=function(){return _createClass((function t(e){_classCallCheck(this,t),this._key=e}),[{key:"algorithm",get:function(){return{name:"DH"}}},{key:"exportKey",value:function(){return this._key}}])}(),DHCipher=exports.DHCipher=function(){function t(){_classCallCheck(this,t),this._g=null,this._p=null,this._gBigInt=null,this._pBigInt=null,this._privateKey=null}return _createClass(t,[{key:"algorithm",get:function(){return{name:"DH"}}},{key:"_generateKey",value:function(t){var e=t.g,i=t.p;this._keyBytes=i.length,this._gBigInt=(0,_bigint.u8ArrayToBigInt)(e),this._pBigInt=(0,_bigint.u8ArrayToBigInt)(i),this._privateKey=window.crypto.getRandomValues(new Uint8Array(this._keyBytes)),this._privateKeyBigInt=(0,_bigint.u8ArrayToBigInt)(this._privateKey),this._publicKey=(0,_bigint.bigIntToU8Array)((0,_bigint.modPow)(this._gBigInt,this._privateKeyBigInt,this._pBigInt),this._keyBytes)}},{key:"deriveBits",value:function(t,e){var i=Math.ceil(e/8),r=new Uint8Array(t.public),n=i>this._keyBytes?i:this._keyBytes,o=(0,_bigint.modPow)((0,_bigint.u8ArrayToBigInt)(r),this._privateKeyBigInt,this._pBigInt);return(0,_bigint.bigIntToU8Array)(o,n).slice(0,n)}}],[{key:"generateKey",value:function(e,i){var r=new t;return r._generateKey(e),{privateKey:r,publicKey:new DHPublicKey(r._publicKey)}}}])}();
//# sourceMappingURL=/sm/7b3f532077a84c5c65b30c29bd3a6e8049bd6f448ec0f66ccb9e8aad7cae68f7.map